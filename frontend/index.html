<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Flappy Bird Sol - Bet & Fly!</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <div class="container">
    <h1>Flappy Bird Sol - Bet & Fly!</h1>
    <button id="connect-wallet">Connect Phantom Wallet</button>
    <div id="deposit-form" style="display: none;">
      <input id="amount" placeholder="Bet Amount (SOL, e.g., 0.01)" type="number" step="0.01" min="0.01">
      <input id="multiplier" placeholder="Multiplier (e.g., 2)" type="number" step="0.1" min="1">
      <input id="pipes" placeholder="Target Pipes (e.g., 5)" type="number" min="1">
      <button onclick="startDeposit()">Deposit & Play</button>
    </div>
    <div id="qr-section" style="display: none;">
      <h2>Scan to Deposit</h2>
      <canvas id="qr-canvas"></canvas>
      <p>Deposit to: <strong id="dep-address">AXDddm4GDjKefAqScFc12Qg3DHk65ZkVRamx9j5vsxU6</strong></p>
      <p>Send exact amount from your wallet. Confirming...</p>
    </div>
    <div id="game-section" style="display: none;">
      <h2>Fly Through ${targetPipes || ''} Pipes!</h2>
      <canvas id="game-canvas" width="400" height="600"></canvas>
      <p>Press <strong>SPACE</strong> to jump. Pass ${targetPipes || ''} pipes to win!</p>
    </div>
  </div>
  <script src="https://unpkg.com/@solana/web3.js@latest/lib/index.iife.min.js"></script>
  <script src="/node_modules/qrcode/build/qrcode.min.js"></script>
  <script>
    if (typeof QRCode === 'undefined') {
      console.warn('Local QRCode not loaded, trying CDN...');
      const script = document.createElement('script');
      script.src = 'https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js';
      script.onload = () => console.log('QRCode CDN loaded successfully');
      script.onerror = () => {
        console.error('QRCode CDN failed to load');
        alert('Failed to load QR code library. Please refresh or check your internet.');
      };
      document.head.appendChild(script);
    } else {
      console.log('Local QRCode loaded successfully');
    }
  </script>
  <script src="wallet.js"></script>
  <script src="game.js"></script>
</body>
</html>